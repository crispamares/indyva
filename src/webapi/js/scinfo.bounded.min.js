/*!
 * Lo-Dash 0.10.0 <http://lodash.com>
 * (c) 2012 John-David Dalton <http://allyoucanleet.com/>
 * Based on Underscore.js 1.4.2 <http://underscorejs.org>
 * (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
 * Available under MIT license <http://lodash.com/license>
 */(function(a,b){function mb(a){if(a&&a.__wrapped__)return a;if(!(this instanceof mb))return new mb(a);this.__wrapped__=a}function rb(a,b,c){b||(b=0);var d=a.length,e=d-b>=(c||i);if(e){var f={},g=b-1;while(++g<d){var h=a[g]+"";(D.call(f,h)?f[h]:f[h]=[]).push(a[g])}}return function(c){if(e){var d=c+"";return D.call(f,d)&&Hc(f[d],c)>-1}return Hc(a,c,b)>-1}}function sb(a){return a.charCodeAt(0)}function tb(a,c){var d=a.index,e=c.index;a=a.criteria,c=c.criteria;if(a!==c){if(a>c||a===b)return 1;if(a<c||c===b)return-1}return d<e?-1:1}function ub(a,b,c){function g(){var h=arguments,i=e?this:b;d||(a=b[f]),c.length&&(h=h.length?c.concat(G.call(h)):c);if(this instanceof g){zb.prototype=a.prototype,i=new zb;var j=a.apply(i,h);return Wb(j)?j:i}return a.apply(i,h)}var d=Vb(a),e=!c,f=b;return e&&(c=b),d||(b=a),g}function vb(a,c){return a?typeof a!="function"?function(b){return b[a]}:c!==b?function(b,d,e){return a.call(c,b,d,e)}:a:gd}function wb(){var a={arrayLoop:"",bottom:"",hasDontEnumBug:Z,isKeysFast:hb,objectLoop:"",noArgsEnum:ab,noCharByIndex:db,shadowed:x,top:"",useHas:!0};for(var b,c=0;b=arguments[c];c++)for(var d in b)a[d]=b[d];var e=a.args;a.firstArg=/^[^,]+/.exec(e)[0];var f=Function("createCallback, hasOwnProperty, isArguments, isString, objectTypes, nativeKeys, propertyIsEnumerable","return function("+e+") {\n"+nb(a)+"\n}");return f(vb,D,Cb,ac,kb,M,F)}function xb(a){return"\\"+lb[a]}function yb(a){return Hb[a]}function zb(){}function Ab(a){return Ib[a]}function Cb(a){return H.call(a)==Q}function Fb(a){var b=!1;if(!a||typeof a!="object"||Cb(a))return b;var c=a.constructor;return(!eb||typeof a.toString=="function"||typeof (a+"")!="string")&&(!Vb(c)||c instanceof c)?$?(Db(a,function(a,c,d){return b=!D.call(d,c),!1}),b===!1):(Db(a,function(a,c){b=c}),b===!1||D.call(a,b)):b}function Gb(a){var b=[];return Eb(a,function(a,c){b.push(c)}),b}function Jb(a,b,c,d,e){if(a==null)return a;c&&(b=!1);var f=Wb(a);if(f){var g=H.call(a);if(!jb[g]||bb&&Cb(a))return a;var h=g==R;f=h||(g==W?$b(a):f)}if(!f||!b)return f?h?G.call(a):Bb({},a):a;var i=a.constructor;switch(g){case S:case T:return new i(+a);case V:case Y:return new i(a);case X:return i(a.source,p.exec(a))}d||(d=[]),e||(e=[]);var j=d.length;while(j--)if(d[j]==a)return e[j];var k=h?i(a.length):{};return d.push(a),e.push(k),(h?nc:Eb)(a,function(a,c){k[c]=Jb(a,b,null,d,e)}),k}function Lb(a){var b=[];return Db(a,function(a,c){Vb(a)&&b.push(c)}),b.sort()}function Mb(a,b){return a?D.call(a,b):!1}function Nb(a){var b={};return Eb(a,function(a,c){b[a]=c}),b}function Pb(a){return a===!0||a===!1||H.call(a)==S}function Qb(a){return H.call(a)==T}function Rb(a){return a?a.nodeType===1:!1}function Sb(a){var b=!0;if(!a)return b;var c=H.call(a),d=a.length;return c==R||c==Y||c==Q||bb&&Cb(a)||c==W&&typeof d=="number"&&Vb(a.splice)?!d:(Eb(a,function(){return b=!1}),b)}function Tb(a,b,c,d){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;var e=H.call(a);if(e!=H.call(b))return!1;switch(e){case S:case T:return+a==+b;case V:return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case X:case Y:return a==b+""}var f=e==R||e==Q;if(bb&&!f&&(f=Cb(a))&&!Cb(b))return!1;if(!f){if(a.__wrapped__||b.__wrapped__)return Tb(a.__wrapped__||a,b.__wrapped__||b);if(e!=W||eb&&(typeof a.toString!="function"&&typeof (a+"")=="string"||typeof b.toString!="function"&&typeof (b+"")=="string"))return!1;var g=a.constructor,h=b.constructor;if(g!=h&&!(Vb(g)&&g instanceof g&&Vb(h)&&h instanceof h))return!1}c||(c=[]),d||(d=[]);var i=c.length;while(i--)if(c[i]==a)return d[i]==b;var j=-1,k=!0,l=0;c.push(a),d.push(b);if(f){l=a.length,k=l==b.length;if(k)while(l--)if(!(k=Tb(a[l],b[l],c,d)))break;return k}for(var m in a)if(D.call(a,m)){l++;if(!D.call(b,m)||!Tb(a[m],b[m],c,d))return!1}for(m in b)if(D.call(b,m)&&!(l--))return!1;if(Z)while(++j<7){m=x[j];if(D.call(a,m)&&(!D.call(b,m)||!Tb(a[m],b[m],c,d)))return!1}return!0}function Ub(a){return K(a)&&!L(parseFloat(a))}function Vb(a){return typeof a=="function"}function Wb(a){return a?kb[typeof a]:!1}function Xb(a){return H.call(a)==V&&a!=+a}function Yb(a){return a===null}function Zb(a){return H.call(a)==V}function _b(a){return H.call(a)==X}function ac(a){return H.call(a)==Y}function bc(a){return a===b}function dc(a,b,c){var d=arguments,e=0,f=2,g=d[3],i=d[4];c!==h&&(g=[],i=[],typeof c!="number"&&(f=d.length));while(++e<f)Eb(d[e],function(b,c){var d,e,f;if(b&&((e=Ob(b))||$b(b))){var j=g.length;while(j--){d=g[j]==b;if(d)break}d?a[c]=i[j]:(g.push(b),i.push(f=(f=a[c],e)?Ob(f)?f:[]:$b(f)?f:{}),a[c]=dc(f,b,h,g,i))}else b!=null&&(a[c]=b)});return a}function ec(a,b,c){var d=typeof b=="function",f={};if(d)b=vb(b,c);else var g=A.apply(e,arguments);return Db(a,function(a,c,e){if(d?!b(a,c,e):Hc(g,c,1)<0)f[c]=a}),f}function fc(a){var b=[];return Eb(a,function(a,c){b.push([c,a])}),b}function gc(a,b,c){var d={};if(typeof b!="function"){var f=0,g=A.apply(e,arguments),h=g.length;while(++f<h){var i=g[f];i in a&&(d[i]=a[i])}}else b=vb(b,c),Db(a,function(a,c,e){b(a,c,e)&&(d[c]=a)});return d}function hc(a){var b=[];return Eb(a,function(a){b.push(a)}),b}function ic(a,b,c){var d=-1,e=a?a.length:0,f=!1;return c=(c<0?N(0,e+c):c)||0,typeof e=="number"?f=(ac(a)?a.indexOf(b,c):Hc(a,b,c))>-1:nc(a,function(a){if(++d>=c)return!(f=a===b)}),f}function jc(a,b,c){var d={};return b=vb(b,c),nc(a,function(a,c,e){c=b(a,c,e),D.call(d,c)?d[c]++:d[c]=1}),d}function kc(a,b,c){var d=!0;b=vb(b,c);if(Ob(a)){var e=-1,f=a.length;while(++e<f)if(!(d=!!b(a[e],e,a)))break}else nc(a,function(a,c,e){return d=!!b(a,c,e)});return d}function lc(a,b,c){var d=[];b=vb(b,c);if(Ob(a)){var e=-1,f=a.length;while(++e<f){var g=a[e];b(g,e,a)&&d.push(g)}}else nc(a,function(a,c,e){b(a,c,e)&&d.push(a)});return d}function mc(a,b,c){var d;return b=vb(b,c),nc(a,function(a,c,e){if(b(a,c,e))return d=a,!1}),d}function oc(a,b,c){var d={};return b=vb(b,c),nc(a,function(a,c,e){c=b(a,c,e),(D.call(d,c)?d[c]:d[c]=[]).push(a)}),d}function pc(a,b){var c=G.call(arguments,2),d=typeof b=="function",e=[];return nc(a,function(a){e.push((d?b:a[b]).apply(a,c))}),e}function qc(a,b,c){var d=-1,e=a?a.length:0,f=Array(typeof e=="number"?e:0);b=vb(b,c);if(Ob(a))while(++d<e)f[d]=b(a[d],d,a);else nc(a,function(a,c,e){f[++d]=b(a,c,e)});return f}function rc(a,b,c){var d=-Infinity,e=-1,f=a?a.length:0,g=d;if(b||!Ob(a))b=!b&&ac(a)?sb:vb(b,c),nc(a,function(a,c,e){var f=b(a,c,e);f>d&&(d=f,g=a)});else while(++e<f)a[e]>g&&(g=a[e]);return g}function sc(a,b,c){var d=Infinity,e=-1,f=a?a.length:0,g=d;if(b||!Ob(a))b=!b&&ac(a)?sb:vb(b,c),nc(a,function(a,c,e){var f=b(a,c,e);f<d&&(d=f,g=a)});else while(++e<f)a[e]<g&&(g=a[e]);return g}function tc(a,b){var c=[];return nc(a,function(a){c.push(a[b])}),c}function uc(a,b,c,d){var e=arguments.length<3;return b=vb(b,d),nc(a,function(a,d,f){c=e?(e=!1,a):b(c,a,d,f)}),c}function vc(a,b,c,d){var e=a,f=a?a.length:0,g=arguments.length<3;if(typeof f!="number"){var h=cc(a);f=h.length}else db&&ac(a)&&(e=a.split(""));return nc(a,function(a,i,j){i=h?h[--f]:--f,c=g?(g=!1,e[i]):b.call(d,c,e[i],i,j)}),c}function wc(a,b,c){return b=vb(b,c),lc(a,function(a,c,d){return!b(a,c,d)})}function xc(a){var b=-1,c=Array(a?a.length:0);return nc(a,function(a){var d=B(P()*(++b+1));c[b]=c[d],c[d]=a}),c}function yc(a){var b=a?a.length:0;return typeof b=="number"?b:cc(a).length}function zc(a,b,c){var d;b=vb(b,c);if(Ob(a)){var e=-1,f=a.length;while(++e<f)if(d=b(a[e],e,a))break}else nc(a,function(a,c,e){return!(d=b(a,c,e))});return!!d}function Ac(a,b,c){var d=[];b=vb(b,c),nc(a,function(a,c,e){d.push({criteria:b(a,c,e),index:c,value:a})});var e=d.length;d.sort(tb);while(e--)d[e]=d[e].value;return d}function Bc(a){return a&&typeof a.length=="number"?(cb?ac(a):typeof a=="string")?a.split(""):G.call(a):hc(a)}function Cc(a,b){var c=cc(b);return lc(a,function(a){var d=c.length;while(d--){var e=a[c[d]]===b[c[d]];if(!e)break}return!!e})}function Dc(a){var b=-1,c=a?a.length:0,d=[];while(++b<c){var e=a[b];e&&d.push(e)}return d}function Ec(a){var b=-1,c=a?a.length:0,d=A.apply(e,arguments),f=rb(d,c),g=[];while(++b<c){var h=a[b];f(h)||g.push(h)}return g}function Fc(a,b,c){if(a)return b==null||c?a[0]:G.call(a,0,b)}function Gc(a,b){var c=-1,d=a?a.length:0,e=[];while(++c<d){var f=a[c];Ob(f)?E.apply(e,b?f:Gc(f)):e.push(f)}return e}function Hc(a,b,c){var d=-1,e=a?a.length:0;if(typeof c=="number")d=(c<0?N(0,e+c):c||0)-1;else if(c)return d=Pc(a,b),a[d]===b?d:-1;while(++d<e)if(a[d]===b)return d;return-1}function Ic(a,b,c){return a?G.call(a,0,-(b==null||c?1:b)):[]}function Jc(a){var b=arguments,c=b.length,d={},e=[];return nc(a,function(a){if(Hc(e,a)<0){var f=c;while(--f)if(!(d[f]||(d[f]=rb(b[f])))(a))return;e.push(a)}}),e}function Kc(a,b,c){if(a){var d=a.length;return b==null||c?a[d-1]:G.call(a,-b||d)}}function Lc(a,b,c){var d=a?a.length:0;typeof c=="number"&&(d=(c<0?N(0,d+c):O(c,d-1))+1);while(d--)if(a[d]===b)return d;return-1}function Mc(a,b){var c=-1,d=a?a.length:0,e={};while(++c<d){var f=a[c];b?e[f]=b[c]:e[f[0]]=f[1]}return e}function Nc(a,b,c){a=+a||0,c=+c||1,b==null&&(b=a,a=0);var d=-1,e=N(0,z((b-a)/c)),f=Array(e);while(++d<e)f[d]=a,a+=c;return f}function Oc(a,b,c){return a?G.call(a,b==null||c?1:b):[]}function Pc(a,b,c,d){var e=0,f=a?a.length:e;c=c?vb(c,d):gd,b=c(b);while(e<f){var g=e+f>>>1;c(a[g])<b?e=g+1:f=g}return e}function Qc(){return Rc(A.apply(e,arguments))}function Rc(a,b,c,d){var e=-1,f=a?a.length:0,g=[],h=g;typeof b=="function"&&(d=c,c=b,b=!1);var i=!b&&f>74;if(i)var j={};c&&(h=[],c=vb(c,d));while(++e<f){var k=a[e],l=c?c(k,e,a):k;i&&(h=D.call(j,l+"")?j[l]:j[l]=[]);if(b?!e||h[h.length-1]!==l:Hc(h,l)<0)(c||i)&&h.push(l),g.push(k)}return g}function Sc(a){var b=-1,c=a?a.length:0,d=rb(arguments,1,20),e=[];while(++b<c){var f=a[b];d(f)||e.push(f)}return e}function Tc(a){var b=-1,c=a?rc(tc(arguments,"length")):0,d=Array(c);while(++b<c)d[b]=tc(arguments,b);return d}function Uc(a,b){return a<1?b():function(){if(--a<1)return b.apply(this,arguments)}}function Vc(a,b){return gb||I&&arguments.length>2?I.call.apply(I,arguments):ub(a,b,G.call(arguments,2))}function Wc(a){var b=arguments,c=b.length>1?0:(b=Lb(a),-1),d=b.length;while(++c<d){var e=b[c];a[e]=Vc(a[e],a)}return a}function Xc(a,b){return ub(a,b,G.call(arguments,2))}function Yc(){var a=arguments;return function(){var b=arguments,c=a.length;while(c--)b=[a[c].apply(this,b)];return b[0]}}function Zc(a,b,c){function h(){g=null,c||(e=a.apply(f,d))}var d,e,f,g;return function(){var i=c&&!g;return d=arguments,f=this,clearTimeout(g),g=setTimeout(h,b),i&&(e=a.apply(f,d)),e}}function $c(a,c){var d=G.call(arguments,2);return setTimeout(function(){a.apply(b,d)},c)}function _c(a){var c=G.call(arguments,1);return setTimeout(function(){a.apply(b,c)},1)}function ad(a,b){var c={};return function(){var d=b?b.apply(this,arguments):arguments[0];return D.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}}function bd(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}}function cd(a){return ub(a,G.call(arguments,1))}function dd(a,b){function h(){g=new Date,f=null,d=a.apply(e,c)}var c,d,e,f,g=0;return function(){var i=new Date,j=b-(i-g);return c=arguments,e=this,j<=0?(clearTimeout(f),g=i,d=a.apply(e,c)):f||(f=setTimeout(h,j)),d}}function ed(a,b){return function(){var c=[a];return E.apply(c,arguments),b.apply(this,c)}}function fd(a){return a==null?"":(a+"").replace(v,yb)}function gd(a){return a}function hd(a){nc(Lb(a),function(b){var c=mb[b]=a[b];mb.prototype[b]=function(){var a=[this.__wrapped__];E.apply(a,arguments);var b=c.apply(mb,a);return this.__chain__&&(b=new mb(b),b.__chain__=!0),b}})}function id(){return a._=j,this}function jd(a,b){return a==null&&b==null&&(b=1),a=+a||0,b==null&&(b=a,a=0),a+B(P()*((+b||0)-a+1))}function kd(a,b){var c=a?a[b]:null;return Vb(c)?a[b]():c}function ld(a,b,c){a||(a=""),c||(c={});var d,e,f=mb.templateSettings,g=0,h=c.interpolate||f.interpolate||u,i="__p += '",j=c.variable||f.variable,l=j,p=RegExp((c.escape||f.escape||u).source+"|"+h.source+"|"+(h===t?s:u).source+"|"+(c.evaluate||f.evaluate||u).source+"|$","g");a.replace(p,function(b,c,e,f,h,j){e||(e=f),i+=a.slice(g,j).replace(w,xb),i+=c?"' +\n__e("+c+") +\n'":h?"';\n"+h+";\n__p += '":e?"' +\n((__t = ("+e+")) == null ? '' : __t) +\n'":"",d||(d=h||k.test(c||e)),g=j+b.length}),i+="';\n";if(!l){j="obj";if(d)i="with ("+j+") {\n"+i+"\n}\n";else{var r=RegExp("(\\(\\s*)"+j+"\\."+j+"\\b","g");i=i.replace(q,"$&"+j+".").replace(r,"$1__d")}}i=(d?i.replace(m,""):i).replace(n,"$1").replace(o,"$1;"),i="function("+j+") {\n"+(l?"":j+" || ("+j+" = {});\n")+"var __t, __p = '', __e = _.escape"+(d?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":(l?"":", __d = "+j+"."+j+" || "+j)+";\n")+i+"return __p\n}";var v=ib?"\n//@ sourceURL="+(c.sourceURL||"/lodash/template/source["+y++ +"]"):"";try{e=Function("_","return "+i+v)(mb)}catch(x){throw x.source=i,x}return b?e(b):(e.source=i,e)}function md(a,b,c){a=+a||0;var d=-1,e=Array(a);while(++d<a)e[d]=b.call(c,d);return e}function nd(a){return a==null?"":(a+"").replace(l,Ab)}function od(a){var b=g++;return a?a+b:b}function pd(a){return a=new mb(a),a.__chain__=!0,a}function qd(a,b){return b(a),a}function rd(){return this.__chain__=!0,this}function sd(){return this.__wrapped__}var c=typeof exports=="object"&&exports,d=typeof global=="object"&&global;d.global===d&&(a=d);var e=[],f=new function(){},g=0,h=f,i=30,j=a._,k=/[-?+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/,l=/&(?:amp|lt|gt|quot|#x27);/g,m=/\b__p \+= '';/g,n=/\b(__p \+=) '' \+/g,o=/(__e\(.*?\)|\b__t\)) \+\n'';/g,p=/\w*$/,q=/(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g,r=RegExp("^"+(f.valueOf+"").replace(/[.*+?^=!:${}()|[\]\/\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),s=/\$\{((?:(?=\\?)\\?[\s\S])*?)}/g,t=/<%=([\s\S]+?)%>/g,u=/($^)/,v=/[&<>"']/g,w=/['\n\r\t\u2028\u2029\\]/g,x=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],y=0,z=Math.ceil,A=e.concat,B=Math.floor,C=r.test(C=Object.getPrototypeOf)&&C,D=f.hasOwnProperty,E=e.push,F=f.propertyIsEnumerable,G=e.slice,H=f.toString,I=r.test(I=G.bind)&&I,J=r.test(J=Array.isArray)&&J,K=a.isFinite,L=a.isNaN,M=r.test(M=Object.keys)&&M,N=Math.max,O=Math.min,P=Math.random,Q="[object Arguments]",R="[object Array]",S="[object Boolean]",T="[object Date]",U="[object Function]",V="[object Number]",W="[object Object]",X="[object RegExp]",Y="[object String]",Z,$,_=(_={0:1,length:1},e.splice.call(_,0,1),_[0]),ab=!0;(function(){function b(){this.x=1}var a=[];b.prototype={valueOf:1,y:1};for(var c in new b)a.push(c);for(c in arguments)ab=!c;Z=!/valueOf/.test(a),$=a[0]!="x"})(1);var bb=!Cb(arguments),cb=G.call("x")[0]!="x",db="x"[0]+Object("x")[0]!="xx";try{var eb=({toString:0}+"",H.call(a.document||0)==W)}catch(fb){}var gb=I&&/\n|Opera/.test(I+H.call(a.opera)),hb=M&&/^.+$|true/.test(M+!!a.attachEvent);try{var ib=(Function("//@")(),!a.attachEvent)}catch(fb){}var jb={};jb[Q]=jb[U]=!1,jb[R]=jb[S]=jb[T]=jb[V]=jb[W]=jb[X]=jb[Y]=!0;var kb={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,"undefined":!1},lb={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"};mb.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:t,variable:""};var nb=ld("<% if (obj.useStrict) { %>'use strict';\n<% } %>var index, value, iteratee = <%= firstArg %>, result = <%= firstArg %>;\nif (!<%= firstArg %>) return result;\n<%= top %>;\n<% if (arrayLoop) { %>var length = iteratee.length; index = -1;\nif (typeof length == 'number') {  <% if (noCharByIndex) { %>\n  if (isString(iteratee)) {\n    iteratee = iteratee.split('')\n  }  <% } %>\n  while (++index < length) {\n    value = iteratee[index];\n    <%= arrayLoop %>\n  }\n}\nelse {  <%  } else if (noArgsEnum) { %>\n  var length = iteratee.length; index = -1;\n  if (length && isArguments(iteratee)) {\n    while (++index < length) {\n      value = iteratee[index += ''];\n      <%= objectLoop %>\n    }\n  } else {  <% } %>  <% if (!hasDontEnumBug) { %>\n  var skipProto = typeof iteratee == 'function' && \n    propertyIsEnumerable.call(iteratee, 'prototype');\n  <% } %>  <% if (isKeysFast && useHas) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iteratee] ? nativeKeys(iteratee) : [],\n      length = ownProps.length;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n    <% if (!hasDontEnumBug) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>    value = iteratee[index];\n    <%= objectLoop %>\n    <% if (!hasDontEnumBug) { %>}\n<% } %>  }  <% } else { %>\n  for (index in iteratee) {<%    if (!hasDontEnumBug || useHas) { %>\n    if (<%      if (!hasDontEnumBug) { %>!(skipProto && index == 'prototype')<% }      if (!hasDontEnumBug && useHas) { %> && <% }      if (useHas) { %>hasOwnProperty.call(iteratee, index)<% }    %>) {    <% } %>\n    value = iteratee[index];\n    <%= objectLoop %>;    <% if (!hasDontEnumBug || useHas) { %>\n    }<% } %>\n  }  <% } %>  <% if (hasDontEnumBug) { %>\n\n  var ctor = iteratee.constructor;\n    <% for (var k = 0; k < 7; k++) { %>\n  index = '<%= shadowed[k] %>';\n  if (<%      if (shadowed[k] == 'constructor') {        %>!(ctor && ctor.prototype === iteratee) && <%      } %>hasOwnProperty.call(iteratee, index)) {\n    value = iteratee[index];\n    <%= objectLoop %>\n  }    <% } %>  <% } %>  <% if (arrayLoop || noArgsEnum) { %>\n}<% } %>\n<%= bottom %>;\nreturn result"),ob={args:"object, source, guard",top:"for (var argsIndex = 1, argsLength = typeof guard == 'number' ? 2 : arguments.length; argsIndex < argsLength; argsIndex++) {\n  if ((iteratee = arguments[argsIndex])) {",objectLoop:"result[index] = value",bottom:"  }\n}"},pb={args:"collection, callback, thisArg",top:"callback = createCallback(callback, thisArg)",arrayLoop:"if (callback(value, index, collection) === false) return result",objectLoop:"if (callback(value, index, collection) === false) return result"},qb={arrayLoop:null},Bb=wb(ob);bb&&(Cb=function(a){return a?D.call(a,"callee"):!1});var Db=wb(pb,qb,{useHas:!1}),Eb=wb(pb,qb),Hb={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},Ib=Nb(Hb),Kb=wb(ob,{objectLoop:"if (result[index] == null) "+ob.objectLoop}),Ob=J||function(a){return H.call(a)==R};Vb(/x/)&&(Vb=function(a){return H.call(a)==U});var $b=C?function(a){if(!a||typeof a!="object")return!1;var b=a.valueOf,c=typeof b=="function"&&(c=C(b))&&C(c);return c?a==c||C(a)==c&&!Cb(a):Fb(a)}:Fb,cc=M?function(a){return typeof a=="function"&&F.call(a,"prototype")?Gb(a):Wb(a)?M(a):[]}:Gb,nc=wb(pb);mb.VERSION="0.10.0",mb.assign=Bb,mb.after=Uc,mb.bind=Vc,mb.bindAll=Wc,mb.bindKey=Xc,mb.chain=pd,mb.clone=Jb,mb.compact=Dc,mb.compose=Yc,mb.contains=ic,mb.countBy=jc,mb.debounce=Zc,mb.defaults=Kb,mb.defer=_c,mb.delay=$c,mb.difference=Ec,mb.escape=fd,mb.every=kc,mb.filter=lc,mb.find=mc,mb.first=Fc,mb.flatten=Gc,mb.forEach=nc,mb.forIn=Db,mb.forOwn=Eb,mb.functions=Lb,mb.groupBy=oc,mb.has=Mb,mb.identity=gd,mb.indexOf=Hc,mb.initial=Ic,mb.intersection=Jc,mb.invert=Nb,mb.invoke=pc,mb.isArguments=Cb,mb.isArray=Ob,mb.isBoolean=Pb,mb.isDate=Qb,mb.isElement=Rb,mb.isEmpty=Sb,mb.isEqual=Tb,mb.isFinite=Ub,mb.isFunction=Vb,mb.isNaN=Xb,mb.isNull=Yb,mb.isNumber=Zb,mb.isObject=Wb,mb.isPlainObject=$b,mb.isRegExp=_b,mb.isString=ac,mb.isUndefined=bc,mb.keys=cc,mb.last=Kc,mb.lastIndexOf=Lc,mb.map=qc,mb.max=rc,mb.memoize=ad,mb.merge=dc,mb.min=sc,mb.mixin=hd,mb.noConflict=id,mb.object=Mc,mb.omit=ec,mb.once=bd,mb.pairs=fc,mb.partial=cd,mb.pick=gc,mb.pluck=tc,mb.random=jd,mb.range=Nc,mb.reduce=uc,mb.reduceRight=vc,mb.reject=wc,mb.rest=Oc,mb.result=kd,mb.shuffle=xc,mb.size=yc,mb.some=zc,mb.sortBy=Ac,mb.sortedIndex=Pc,mb.tap=qd,mb.template=ld,mb.throttle=dd,mb.times=md,mb.toArray=Bc,mb.unescape=nd,mb.union=Qc,mb.uniq=Rc,mb.uniqueId=od,mb.values=hc,mb.where=Cc,mb.without=Sc,mb.wrap=ed,mb.zip=Tc,mb.all=kc,mb.any=zc,mb.collect=qc,mb.detect=mc,mb.drop=Oc,mb.each=nc,mb.extend=Bb,mb.foldl=uc,mb.foldr=vc,mb.head=Fc,mb.include=ic,mb.inject=uc,mb.methods=Lb,mb.select=lc,mb.tail=Oc,mb.take=Fc,mb.unique=Rc,mb._iteratorTemplate=nb,hd(mb),mb.prototype.chain=rd,mb.prototype.value=sd,nc(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=e[a];mb.prototype[a]=function(){var a=this.__wrapped__;return b.apply(a,arguments),_&&a.length===0&&delete a[0],this.__chain__&&(a=new mb(a),a.__chain__=!0),a}}),nc(["concat","join","slice"],function(a){var b=e[a];mb.prototype[a]=function(){var a=this.__wrapped__,c=b.apply(a,arguments);return this.__chain__&&(c=new mb(c),c.__chain__=!0),c}}),typeof define=="function"&&typeof define.amd=="object"&&define.amd?(a._=mb,define(function(){return mb})):c?typeof module=="object"&&module&&module.exports==c?(module.exports=mb)._=mb:c._=mb:a._=mb})(this),function(a){a(function(){function d(){}function e(a){return new Array(a)}function f(){}function g(b){var d=new f;return d.then=function(a){i(arguments);var d;try{return a&&(d=a(b)),m(d===c?b:d)}catch(e){return h(e)}},a(d)}function h(b){var d=new f;return d.then=function(a,d){i(arguments);var e;try{return d?(e=d(b),m(e===c?b:e)):h(b)}catch(f){return h(f)}},a(d)}function i(a){var b,c=a.length;while(c){b=a[--c];if(b!=null&&typeof b!="function")throw new Error("callback is not a function")}}function j(){function o(a,b,c){return l(a,b,c)}function p(a){n(g(a))}function q(a){n(h(a))}function r(a){m(a)}var b,d,e,k,l,m,n;return e=[],k=[],l=function(b,c,d){i(arguments);var f=j();return e.push(function(a){a.then(b,c).then(f.resolve,f.reject,f.progress)}),d&&k.push(d),f.promise},m=function(a){var b,c=0;while(b=k[c++])b(a)},n=function(a){var b,d=0;l=a.then,n=m=function(){throw new Error("already completed")},k=c;while(b=e[d++])b(a);e=[]},b={},d=new f,d.then=b.then=o,b.promise=a(d),b.resolver=a({resolve:b.resolve=p,reject:b.reject=q,progress:b.progress=r}),b}function k(a){return a&&typeof a.then=="function"}function l(a,b,c,d){var e=m(a);return e.then(b,c,d)}function m(a){var b,c;return a instanceof f?b=a:(c=j(),k(a)?(a.then(c.resolve,c.reject,c.progress),b=c.promise):(c.resolve(a),b=c.promise)),b}function n(a,b,c,e,f){function r(a){m(a)}function s(a){n(a)}function t(a){o(a)}function u(){m=n=o=d}var g,h,i,k,m,n,o,p,q;p=a.length>>>0,g=Math.max(0,Math.min(b,p)),h=[],k=j(),i=l(k,c,e,f);if(!g)k.resolve(h);else{m=function(a){h.push(a),--g||(u(),k.resolve(h))},n=function(a){u(),k.reject(a)},o=k.progress;for(q=0;q<p;++q)q in a&&l(a[q],r,s,t)}return i}function o(a,b,c,d){var f,g;return f=e(a.length),g=s(a,p,f),l(g,b,c,d)}function p(a,b,c){return a[c]=b,a}function q(a,b,c,d){function e(a){return b(a[0])}return n(a,1,e,c,d)}function r(a,b){var c,d;d=a.length,c=e(d);for(;d>=0;--d)d in a&&(c[d]=l(a[d],b));return s(c,p,c)}function s(a,c,d){var e,f;return e=a.length,f=[function(a,b,d){return l(a,function(a){return l(b,function(b){return c(a,b,d,e)})})}],arguments.length>=3&&f.push(d),m(b.apply(a,f))}function t(a,b,c){var d=arguments.length>2;return l(a,function(a){return d&&(a=c),b.resolve(a),a},function(a){return b.reject(a),h(a)},b.progress)}var a,b,c;return a=Object.freeze||function(a){return a},b=[].reduce||function(a){var b,c,d,e,f;f=0,b=Object(this),e=b.length>>>0,c=arguments;if(c.length<=1)for(;;){if(f in b){d=b[f++];break}if(++f>=e)throw new TypeError}else d=c[1];for(;f<e;++f)f in b&&(d=a(d,b[f],f,b));return d},l.defer=j,l.isPromise=k,l.some=n,l.all=o,l.any=q,l.reduce=s,l.map=r,l.chain=t,l})}(typeof define=="function"?define:function(a){typeof module!="undefined"?module.exports=a():this.when=a()}),(typeof Crypto=="undefined"||!Crypto.util)&&function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b=window.Crypto={},c=b.util={rotl:function(a,b){return a<<b|a>>>32-b},rotr:function(a,b){return a<<32-b|a>>>b},endian:function(a){if(a.constructor==Number)return c.rotl(a,8)&16711935|c.rotl(a,24)&4278255360;for(var b=0;b<a.length;b++)a[b]=c.endian(a[b]);return a},randomBytes:function(a){for(var b=[];a>0;a--)b.push(Math.floor(Math.random()*256));return b},bytesToWords:function(a){for(var b=[],c=0,d=0;c<a.length;c++,d+=8)b[d>>>5]|=(a[c]&255)<<24-d%32;return b},wordsToBytes:function(a){for(var b=[],c=0;c<a.length*32;c+=8)b.push(a[c>>>5]>>>24-c%32&255);return b},bytesToHex:function(a){for(var b=[],c=0;c<a.length;c++)b.push((a[c]>>>4).toString(16)),b.push((a[c]&15).toString(16));return b.join("")},hexToBytes:function(a){for(var b=[],c=0;c<a.length;c+=2)b.push(parseInt(a.substr(c,2),16));return b},bytesToBase64:function(b){if(typeof btoa=="function")return btoa(f.bytesToString(b));for(var c=[],d=0;d<b.length;d+=3){var e=b[d]<<16|b[d+1]<<8|b[d+2];for(var g=0;g<4;g++)d*8+g*6<=b.length*8?c.push(a.charAt(e>>>6*(3-g)&63)):c.push("=")}return c.join("")},base64ToBytes:function(b){if(typeof atob=="function")return f.stringToBytes(atob(b));b=b.replace(/[^A-Z0-9+\/]/ig,"");for(var c=[],d=0,e=0;d<b.length;e=++d%4){if(e==0)continue;c.push((a.indexOf(b.charAt(d-1))&Math.pow(2,-2*e+8)-1)<<e*2|a.indexOf(b.charAt(d))>>>6-e*2)}return c}},d=b.charenc={},e=d.UTF8={stringToBytes:function(a){return f.stringToBytes(unescape(encodeURIComponent(a)))},bytesToString:function(a){return decodeURIComponent(escape(f.bytesToString(a)))}},f=d.Binary={stringToBytes:function(a){for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c)&255);return b},bytesToString:function(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}}}(),(typeof Crypto=="undefined"||!Crypto.util)&&function(){var a=window.Crypto={},b=a.util={rotl:function(a,b){return a<<b|a>>>32-b},rotr:function(a,b){return a<<32-b|a>>>b},endian:function(a){if(a.constructor==Number)return b.rotl(a,8)&16711935|b.rotl(a,24)&4278255360;for(var c=0;c<a.length;c++)a[c]=b.endian(a[c]);return a},randomBytes:function(a){for(var b=[];a>0;a--)b.push(Math.floor(Math.random()*256));return b},bytesToWords:function(a){for(var b=[],c=0,d=0;c<a.length;c++,d+=8)b[d>>>5]|=(a[c]&255)<<24-d%32;return b},wordsToBytes:function(a){for(var b=[],c=0;c<a.length*32;c+=8)b.push(a[c>>>5]>>>24-c%32&255);return b},bytesToHex:function(a){for(var b=[],c=0;c<a.length;c++)b.push((a[c]>>>4).toString(16)),b.push((a[c]&15).toString(16));return b.join("")},hexToBytes:function(a){for(var b=[],c=0;c<a.length;c+=2)b.push(parseInt(a.substr(c,2),16));return b},bytesToBase64:function(a){if(typeof btoa=="function")return btoa(c.bytesToString(a));for(var b=[],d=0;d<a.length;d+=3)for(var e=a[d]<<16|a[d+1]<<8|a[d+2],f=0;f<4;f++)d*8+f*6<=a.length*8?b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e>>>6*(3-f)&63)):b.push("=");return b.join("")},base64ToBytes:function(a){if(typeof atob=="function")return c.stringToBytes(atob(a));for(var a=a.replace(/[^A-Z0-9+\/]/ig,""),b=[],d=0,e=0;d<a.length;e=++d%4)e!=0&&b.push(("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(d-1))&Math.pow(2,-2*e+8)-1)<<e*2|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(d))>>>6-e*2);return b}},a=a.charenc={};a.UTF8={stringToBytes:function(a){return c.stringToBytes(unescape(encodeURIComponent(a)))},bytesToString:function(a){return decodeURIComponent(escape(c.bytesToString(a)))}};var c=a.Binary={stringToBytes:function(a){for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c)&255);return b},bytesToString:function(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}}}(),function(){var a=Crypto,b=a.util,c=a.charenc,d=c.UTF8,e=c.Binary,f=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],g=a.SHA256=function(a,c){var d=b.wordsToBytes(g._sha256(a));return c&&c.asBytes?d:c&&c.asString?e.bytesToString(d):b.bytesToHex(d)};g._sha256=function(a){a.constructor==String&&(a=d.stringToBytes(a));var c=b.bytesToWords(a),e=a.length*8,a=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],g=[],h,i,j,l,m,n,o,p,q,r,s;c[e>>5]|=128<<24-e%32,c[(e+64>>9<<4)+15]=e;for(p=0;p<c.length;p+=16){e=a[0],h=a[1],i=a[2],j=a[3],l=a[4],m=a[5],n=a[6],o=a[7];for(q=0;q<64;q++){q<16?g[q]=c[q+p]:(r=g[q-15],s=g[q-2],g[q]=((r<<25|r>>>7)^(r<<14|r>>>18)^r>>>3)+(g[q-7]>>>0)+((s<<15|s>>>17)^(s<<13|s>>>19)^s>>>10)+(g[q-16]>>>0)),s=e&h^e&i^h&i;var t=(e<<30|e>>>2)^(e<<19|e>>>13)^(e<<10|e>>>22);r=(o>>>0)+((l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25))+(l&m^~l&n)+f[q]+(g[q]>>>0),s=t+s,o=n,n=m,m=l,l=j+r>>>0,j=i,i=h,h=e,e=r+s>>>0}a[0]+=e,a[1]+=h,a[2]+=i,a[3]+=j,a[4]+=l,a[5]+=m,a[6]+=n,a[7]+=o}return a},g._blocksize=16,g._digestsize=32}(),function(){var a=Crypto,b=a.util,c=a.charenc,d=c.UTF8,e=c.Binary;a.HMAC=function(a,c,f,g){c.constructor==String&&(c=d.stringToBytes(c)),f.constructor==String&&(f=d.stringToBytes(f)),f.length>a._blocksize*4&&(f=a(f,{asBytes:!0}));for(var h=f.slice(0),f=f.slice(0),i=0;i<a._blocksize*4;i++)h[i]^=92,f[i]^=54;return a=a(h.concat(a(f.concat(c),{asBytes:!0})),{asBytes:!0}),g&&g.asBytes?a:g&&g.asString?e.bytesToString(a):b.bytesToHex(a)}}(),"use strict";var AUTOBAHNJS_VERSION="?.?.?",AUTOBAHNJS_DEBUG=!0,ab=window.ab={};ab._version=AUTOBAHNJS_VERSION,function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a){"use strict";if(this===null)throw new TypeError;var b=new Object(this),c=b.length>>>0;if(c===0)return-1;var d=0;arguments.length>0&&(d=Number(arguments[1]),d!==d?d=0:d!==0&&d!==Infinity&&d!==-Infinity&&(d=(d>0||-1)*Math.floor(Math.abs(d))));if(d>=c)return-1;var e=d>=0?d:Math.max(c-Math.abs(d),0);for(;e<c;e++)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;if(this===null)throw new TypeError(" this is null or not defined");var e=new Object(this),f=e.length>>>0;if({}.toString.call(a)!=="[object Function]")throw new TypeError(a+" is not a function");b&&(c=b),d=0;while(d<f){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}})}(),ab._sliceUserAgent=function(a,b,c){var d=[],e=navigator.userAgent,f=e.indexOf(a),g=e.indexOf(b,f);g<0&&(g=e.length);var h=e.slice(f,g).split(c),i=h[1].split(".");for(var j=0;j<i.length;++j)d.push(parseInt(i[j],10));return{name:h[0],version:d}},ab.getBrowser=function(){var a=navigator.userAgent;return a.indexOf("Chrome")>-1?ab._sliceUserAgent("Chrome"," ","/"):a.indexOf("Safari")>-1?ab._sliceUserAgent("Safari"," ","/"):a.indexOf("Firefox")>-1?ab._sliceUserAgent("Firefox"," ","/"):a.indexOf("MSIE")>-1?ab._sliceUserAgent("MSIE",";"," "):null},ab.browserNotSupportedMessage="Browser does not support WebSockets (RFC6455)",ab._idchars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",ab._idlen=16,ab._subprotocol="wamp",ab._newid=function(){var a="";for(var b=0;b<ab._idlen;b+=1)a+=ab._idchars.charAt(Math.floor(Math.random()*ab._idchars.length));return a},ab.log=function(a){if(window.console&&console.log)if(arguments.length>1){console.group("Log Item");for(var b=0;b<arguments.length;b+=1)console.log(arguments[b]);console.groupEnd()}else console.log(arguments[0])},ab._debugrpc=!1,ab._debugpubsub=!1,ab._debugws=!1,ab.debug=function(a,b){if(!("console"in window))throw"browser does not support console object";ab._debugrpc=a,ab._debugpubsub=a,ab._debugws=b},ab.version=function(){return ab._version},ab.PrefixMap=function(){var a=this;a._index={},a._rindex={}},ab.PrefixMap.prototype.get=function(a){var b=this;return b._index[a]},ab.PrefixMap.prototype.set=function(a,b){var c=this;c._index[a]=b,c._rindex[b]=a},ab.PrefixMap.prototype.setDefault=function(a){var b=this;b._index[""]=a,b._rindex[a]=""},ab.PrefixMap.prototype.remove=function(a){var b=this,c=b._index[a];c&&(delete b._index[a],delete b._rindex[c])},ab.PrefixMap.prototype.resolve=function(a,b){var c=this,d=a.indexOf(":");if(d>=0){var e=a.substring(0,d);if(c._index[e])return c._index[e]+a.substring(d+1)}return b==1?a:null},ab.PrefixMap.prototype.shrink=function(a,b){var c=this;for(var d=a.length;d>0;d-=1){var e=a.substring(0,d),f=c._rindex[e];if(f)return f+":"+a.substring(d)}return b==1?a:null},ab._MESSAGE_TYPEID_WELCOME=0,ab._MESSAGE_TYPEID_PREFIX=1,ab._MESSAGE_TYPEID_CALL=2,ab._MESSAGE_TYPEID_CALL_RESULT=3,ab._MESSAGE_TYPEID_CALL_ERROR=4,ab._MESSAGE_TYPEID_SUBSCRIBE=5
,ab._MESSAGE_TYPEID_UNSUBSCRIBE=6,ab._MESSAGE_TYPEID_PUBLISH=7,ab._MESSAGE_TYPEID_EVENT=8,ab.CONNECTION_CLOSED=0,ab.CONNECTION_LOST=1,ab.CONNECTION_RETRIES_EXCEEDED=2,ab.CONNECTION_UNREACHABLE=3,ab.CONNECTION_UNSUPPORTED=4,ab.CONNECTION_UNREACHABLE_SCHEDULED_RECONNECT=5,ab.CONNECTION_LOST_SCHEDULED_RECONNECT=6,ab._Deferred=when.defer,ab._construct=function(a,b){return"WebSocket"in window?new WebSocket(a,b):"MozWebSocket"in window?new MozWebSocket(a,b):null},ab.Session=function(a,b,c,d){var e=this;e._wsuri=a,e._options=d,e._websocket_onopen=b,e._websocket_onclose=c,e._websocket=null,e._websocket_connected=!1,e._session_id=null,e._wamp_version=null,e._server=null,e._calls={},e._subscriptions={},e._prefixes=new ab.PrefixMap,e._txcnt=0,e._rxcnt=0,e._websocket=ab._construct(e._wsuri,[ab._subprotocol]);if(!e._websocket){if(c!==undefined){c(ab.CONNECTION_UNSUPPORTED);return}throw ab.browserNotSupportedMessage}e._websocket.onmessage=function(a){ab._debugws&&(e._rxcnt+=1,console.group("WS Receive"),console.info(e._wsuri+"  ["+e._session_id+"]"),console.log(e._rxcnt),console.log(a.data),console.groupEnd());var b=JSON.parse(a.data);if(b[1]in e._calls){if(b[0]===ab._MESSAGE_TYPEID_CALL_RESULT){var c=e._calls[b[1]],d=b[2];if(ab._debugrpc&&c._ab_callobj!==undefined){console.group("WAMP Call",c._ab_callobj[2]),console.timeEnd(c._ab_tid),console.group("Arguments");for(var f=3;f<c._ab_callobj.length;f+=1){var g=c._ab_callobj[f];if(g===undefined)break;console.log(g)}console.groupEnd(),console.group("Result"),console.log(d),console.groupEnd(),console.groupEnd()}c.resolve(d)}else if(b[0]===ab._MESSAGE_TYPEID_CALL_ERROR){var h=e._calls[b[1]],i=b[2],j=b[3],k=b[4];if(ab._debugrpc&&h._ab_callobj!==undefined){console.group("WAMP Call",h._ab_callobj[2]),console.timeEnd(h._ab_tid),console.group("Arguments");for(var l=3;l<h._ab_callobj.length;l+=1){var m=h._ab_callobj[l];if(m===undefined)break;console.log(m)}console.groupEnd(),console.group("Error"),console.log(i),console.log(j),k!==undefined&&console.log(k),console.groupEnd(),console.groupEnd()}k!==undefined?h.reject({uri:i,desc:j,detail:k}):h.reject({uri:i,desc:j})}delete e._calls[b[1]]}else if(b[0]===ab._MESSAGE_TYPEID_EVENT){var n=e._prefixes.resolve(b[1],!0);if(n in e._subscriptions){var o=b[1],p=b[2];ab._debugpubsub&&(console.group("WAMP Event"),console.info(e._wsuri+"  ["+e._session_id+"]"),console.log(o),console.log(p),console.groupEnd()),e._subscriptions[n].forEach(function(a){a(o,p)})}}else if(b[0]===ab._MESSAGE_TYPEID_WELCOME){if(e._session_id!==null)throw"protocol error (welcome message received more than once)";e._session_id=b[1],e._wamp_version=b[2],e._server=b[3];if(ab._debugrpc||ab._debugpubsub)console.group("WAMP Welcome"),console.info(e._wsuri+"  ["+e._session_id+"]"),console.log(e._wamp_version),console.log(e._server),console.groupEnd();e._websocket_onopen!==null&&e._websocket_onopen()}},e._websocket.onopen=function(a){if(e._websocket.protocol!==ab._subprotocol)if(typeof e._websocket.protocol=="undefined")ab._debugws&&(console.group("WS Warning"),console.info(e._wsuri),console.log("WebSocket object has no protocol attribute: WAMP subprotocol check skipped!"),console.groupEnd());else{if(!e._options||!e._options.skipSubprotocolCheck)throw e._websocket.close(1e3,"server does not speak WAMP"),"server does not speak WAMP (but '"+e._websocket.protocol+"' !)";ab._debugws&&(console.group("WS Warning"),console.info(e._wsuri),console.log("Server does not speak WAMP, but subprotocol check disabled by option!"),console.log(e._websocket.protocol),console.groupEnd())}ab._debugws&&(console.group("WAMP Connect"),console.info(e._wsuri),console.log(e._websocket.protocol),console.groupEnd()),e._websocket_connected=!0},e._websocket.onerror=function(a){},e._websocket.onclose=function(a){ab._debugws&&(e._websocket_connected?console.log("Autobahn connection to "+e._wsuri+" lost (code "+a.code+", reason '"+a.reason+"', wasClean "+a.wasClean+")."):console.log("Autobahn could not connect to "+e._wsuri+" (code "+a.code+", reason '"+a.reason+"', wasClean "+a.wasClean+").")),e._websocket_onclose!==undefined&&(e._websocket_connected?a.wasClean?e._websocket_onclose(ab.CONNECTION_CLOSED):e._websocket_onclose(ab.CONNECTION_LOST):e._websocket_onclose(ab.CONNECTION_UNREACHABLE)),e._websocket_connected=!1,e._wsuri=null,e._websocket_onopen=null,e._websocket_onclose=null,e._websocket=null}},ab.Session.prototype._send=function(a){var b=this;if(!b._websocket_connected)throw"Autobahn not connected";var c=JSON.stringify(a);b._websocket.send(c),b._txcnt+=1,ab._debugws&&(console.group("WS Send"),console.info(b._wsuri+"  ["+b._session_id+"]"),console.log(b._txcnt),console.log(c),console.groupEnd())},ab.Session.prototype.close=function(){var a=this;a._websocket_connected&&a._websocket.close()},ab.Session.prototype.sessionid=function(){var a=this;return a._session_id},ab.Session.prototype.shrink=function(a,b){var c=this;return b===undefined&&(b=!0),c._prefixes.shrink(a,b)},ab.Session.prototype.resolve=function(a,b){var c=this;return b===undefined&&(b=!0),c._prefixes.resolve(a,b)},ab.Session.prototype.prefix=function(a,b){var c=this;c._prefixes.set(a,b);if(ab._debugrpc||ab._debugpubsub)console.group("WAMP Prefix"),console.info(c._wsuri+"  ["+c._session_id+"]"),console.log(a),console.log(b),console.groupEnd();var d=[ab._MESSAGE_TYPEID_PREFIX,a,b];c._send(d)},ab.Session.prototype.call=function(){var a=this,b=new ab._Deferred,c;for(;;){c=ab._newid();if(!(c in a._calls))break}a._calls[c]=b;var d=a._prefixes.shrink(arguments[0],!0),e=[ab._MESSAGE_TYPEID_CALL,c,d];for(var f=1;f<arguments.length;f+=1)e.push(arguments[f]);return a._send(e),ab._debugrpc&&(b._ab_callobj=e,b._ab_tid=a._wsuri+"  ["+a._session_id+"]["+c+"]",console.time(b._ab_tid),console.info()),b},ab.Session.prototype.subscribe=function(a,b){var c=this,d=c._prefixes.resolve(a,!0);if(!(d in c._subscriptions)){ab._debugpubsub&&(console.group("WAMP Subscribe"),console.info(c._wsuri+"  ["+c._session_id+"]"),console.log(a),console.log(b),console.groupEnd());var e=[ab._MESSAGE_TYPEID_SUBSCRIBE,a];c._send(e),c._subscriptions[d]=[]}var f=c._subscriptions[d].indexOf(b);if(f!==-1)throw"callback "+b+" already subscribed for topic "+d;c._subscriptions[d].push(b)},ab.Session.prototype.unsubscribe=function(a,b){var c=this,d=c._prefixes.resolve(a,!0);if(!(d in c._subscriptions))throw"not subscribed to topic "+d;var e;if(b!==undefined){var f=c._subscriptions[d].indexOf(b);if(f===-1)throw"no callback "+b+" subscribed on topic "+d;e=b,c._subscriptions[d].splice(f,1)}else e=c._subscriptions[d].slice(),c._subscriptions[d]=[];if(c._subscriptions[d].length===0){delete c._subscriptions[d],ab._debugpubsub&&(console.group("WAMP Unsubscribe"),console.info(c._wsuri+"  ["+c._session_id+"]"),console.log(a),console.log(e),console.groupEnd());var g=[ab._MESSAGE_TYPEID_UNSUBSCRIBE,a];c._send(g)}},ab.Session.prototype.publish=function(){var a=this,b=arguments[0],c=arguments[1],d=null,e=null,f=null,g=null;if(arguments.length>3){if(!(arguments[2]instanceof Array))throw"invalid argument type(s)";if(!(arguments[3]instanceof Array))throw"invalid argument type(s)";e=arguments[2],f=arguments[3],g=[ab._MESSAGE_TYPEID_PUBLISH,b,c,e,f]}else if(arguments.length>2)if(typeof arguments[2]=="boolean")d=arguments[2],g=[ab._MESSAGE_TYPEID_PUBLISH,b,c,d];else{if(!(arguments[2]instanceof Array))throw"invalid argument type(s)";e=arguments[2],g=[ab._MESSAGE_TYPEID_PUBLISH,b,c,e]}else g=[ab._MESSAGE_TYPEID_PUBLISH,b,c];ab._debugpubsub&&(console.group("WAMP Publish"),console.info(a._wsuri+"  ["+a._session_id+"]"),console.log(b),console.log(c),d!==null?console.log(d):e!==null&&(console.log(e),f!==null&&console.log(f)),console.groupEnd()),a._send(g)},ab.Session.prototype.authreq=function(a,b){return this.call("http://api.wamp.ws/procedure#authreq",a,b)},ab.Session.prototype.authsign=function(a,b){return b||(b=""),Crypto.util.bytesToBase64(Crypto.HMAC(Crypto.SHA256,a,b,{asBytes:!0}))},ab.Session.prototype.auth=function(a){return this.call("http://api.wamp.ws/procedure#auth",a)},ab._connect=function(a){var b=new ab.Session(a.wsuri,function(){a.connects+=1,a.retryCount=0,a.onConnect(b)},function(b){switch(b){case ab.CONNECTION_CLOSED:a.onHangup(b,"Connection was closed properly - done.");break;case ab.CONNECTION_UNSUPPORTED:a.onHangup(b,"Browser does not support WebSocket.");break;case ab.CONNECTION_UNREACHABLE:a.retryCount+=1;if(a.connects==0)a.onHangup(b,"Connection could not be established.");else if(a.retryCount<=a.options.maxRetries){var c=a.onHangup(ab.CONNECTION_UNREACHABLE_SCHEDULED_RECONNECT,"Connection unreachable - scheduled reconnect to occur in "+a.options.retryDelay/1e3+" second(s).",{delay:a.options.retryDelay,retries:a.retryCount,maxretries:a.options.maxRetries});c?(console.log("Connection unreachable - retrying stopped by app"),a.onHangup(ab.CONNECTION_RETRIES_EXCEEDED,"Number of connection retries exceeded.")):(console.log("Connection unreachable - retrying ("+a.retryCount+") .."),window.setTimeout(ab._connect,a.options.retryDelay,a))}else a.onHangup(ab.CONNECTION_RETRIES_EXCEEDED,"Number of connection retries exceeded.");break;case ab.CONNECTION_LOST:a.retryCount+=1;if(a.retryCount<=a.options.maxRetries){var c=a.onHangup(ab.CONNECTION_LOST_SCHEDULED_RECONNECT,"Connection lost - scheduled reconnect to occur in "+a.options.retryDelay/1e3+" second(s).",{delay:a.options.retryDelay,retries:a.retryCount,maxretries:a.options.maxRetries});c?(console.log("Connection lost - retrying stopped by app"),a.onHangup(ab.CONNECTION_RETRIES_EXCEEDED,"Connection lost.")):(console.log("Connection lost - retrying ("+a.retryCount+") .."),window.setTimeout(ab._connect,a.options.retryDelay,a))}else a.onHangup(ab.CONNECTION_RETRIES_EXCEEDED,"Connection lost.");break;default:throw"unhandled close code in ab._connect"}},a.options)},ab.connect=function(a,b,c,d){peer={},peer.wsuri=a,d?peer.options=d:peer.options={},peer.options.retryDelay==undefined&&(peer.options.retryDelay=5e3),peer.options.maxRetries==undefined&&(peer.options.maxRetries=10),peer.options.skipSubprotocolCheck==undefined&&(peer.options.skipSubprotocolCheck=!1);if(!b)throw"onConnect handler required!";peer.onConnect=b,c?peer.onHangup=c:peer.onHangup=function(a,b){console.log(b)},peer.connects=0,peer.retryCount=0,ab._connect(peer)},ab._UA_FIREFOX=new RegExp(".*Firefox/([0-9+]*).*"),ab._UA_CHROME=new RegExp(".*Chrome/([0-9+]*).*"),ab._UA_CHROMEFRAME=new RegExp(".*chromeframe/([0-9]*).*"),ab._UA_WEBKIT=new RegExp(".*AppleWebKit/([0-9+.]*)w*.*"),ab._UA_WEBOS=new RegExp(".*webOS/([0-9+.]*)w*.*"),ab._matchRegex=function(a,b){var c=b.exec(a);return c?c[1]:c},ab.lookupWsSupport=function(){var a=navigator.userAgent;if(a.indexOf("MSIE")>-1){if(a.indexOf("MSIE 10")>-1)return[!0,!0,!0];if(a.indexOf("chromeframe")>-1){var b=parseInt(ab._matchRegex(a,ab._UA_CHROMEFRAME));return b>=14?[!0,!1,!0]:[!1,!1,!1]}return a.indexOf("MSIE 8")>-1||a.indexOf("MSIE 9")>-1?[!0,!0,!0]:[!1,!1,!1]}if(a.indexOf("Firefox")>-1){var b=parseInt(ab._matchRegex(a,ab._UA_FIREFOX));return b?b>=7?[!0,!1,!0]:b>=3?[!0,!0,!0]:[!1,!1,!0]:[!1,!1,!0]}if(a.indexOf("Safari")>-1&&a.indexOf("Chrome")==-1){var b=ab._matchRegex(a,ab._UA_WEBKIT);if(b){if(a.indexOf("Windows")>-1&&b=="534+")return[!0,!1,!0];if(a.indexOf("Macintosh")>-1){b=b.replace("+","").split(".");if(parseInt(b[0])==535&&parseInt(b[1])>=24||parseInt(b[0])>535)return[!0,!1,!0]}return a.indexOf("webOS")>-1?(b=ab._matchRegex(a,ab._UA_WEBOS).split("."),parseInt(b[0])==2?[!1,!0,!0]:[!1,!1,!1]):[!0,!0,!0]}return[!1,!1,!1]}if(a.indexOf("Chrome")>-1){var b=parseInt(ab._matchRegex(a,ab._UA_CHROME));return b?b>=14?[!0,!1,!0]:b>=4?[!0,!0,!0]:[!1,!1,!0]:[!1,!1,!1]}if(a.indexOf("Android")>-1)return a.indexOf("Firefox")>-1?[!0,!1,!0]:a.indexOf("CrMo")>-1?[!0,!1,!0]:a.indexOf("Opera")>-1?[!1,!1,!0]:a.indexOf("CrMo")>-1?[!0,!0,!0]:[!1,!1,!1];return a.indexOf("iPhone")>-1||a.indexOf("iPad")>-1||a.indexOf("iPod")>-1?[!1,!1,!0]:[!1,!1,!1]},function(){function b(){return a}function d(b){b=b||{};var d=b.wsuri||"ws://"+window.location.hostname+":9000",e=when.defer(),f=e.resolver;return ab.connect(d,function(b){a=b,_.map(c,function(b){a.prefix(b.name,"http://scinfo.io/"+b.name+"#")}),console.log("Connected to "+d),f.resolve(a)},function(b,c){a=null,b==ab.CONNECTION_UNSUPPORTED?window.location="http://autobahn.ws/unsupportedbrowser":(alert(c),f.reject(b,c))}),e.promise}scinfo={version:"0.1.0"};var a=null;scinfo._session=b;var c=[];scinfo.connectServer=d;var e={name:"data_store",loadData:function(b){console.log("rpc"),a.call("data_store:load_data",b).then(function(a){console.log("ok, data loaded"),console.log(a)})}};c.push(e),scinfo.dataStore=e}();